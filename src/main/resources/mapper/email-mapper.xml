<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kh.avengers.auth.model.dao.EmailMapper">

  <insert id="sendCodeEmail" parameterType="EmailDTO">
    INSERT
      INTO 
           TB_EMAIL
         (
            EMAIL
          , VERIFY_CODE
         )
    VALUES
         (
            #{email}
          , #{verifyCode}
         )
  </insert>

  <select id="checkedVerifyCode" parameterType="EmailDTO" resultType="int">
    SELECT
            EMAIL email
          , VERIFY_CODE verifyCode
          , CREATE_DATE createDate
      FROM
            TB_EMAIL
     WHERE
            EMAIL = #{email}
       AND
            VERIFY_CODE = #{verifyCode}
     ORDER
        BY
            CREATE_DATE DESC
            FETCH FIRST 1 ROWS ONLY  <!-- 최신 코드 1건만 조회가기 위해서-->
  </select>

</mapper>

  